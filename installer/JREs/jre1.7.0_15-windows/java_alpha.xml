<component>
    <name>java</name>
    <description>Java Runtime Environment</description>
    <canBeEdited>0</canBeEdited>
    <selected>1</selected>
    <show>0</show>
    <desktopShortcutList>
        <shortcut>
            <comment></comment>
            <exec></exec>
            <icon></icon>
            <name>${product_shortname} ${product_version}</name>
            <path></path>
            <platforms>all</platforms>
            <runAsAdmin>0</runAsAdmin>
            <runInTerminal>0</runInTerminal>
            <windowsExec>${javaws_executable}</windowsExec>
            <windowsExecArgs>http://vcell.org/webstart/Alpha/vcellalpha.jnlp</windowsExecArgs>
            <windowsIcon>${installdir}/vcell5.ico</windowsIcon>
            <windowsPath></windowsPath>
        </shortcut>
    </desktopShortcutList>

	<!-- folders storing JRE -->
	<folderList>
        <folder>
            <description>Java binaries - Microsoft Windows</description>
            <destination>${installdir}/javavm</destination>
            <name>java_windows</name>
            <platforms>windows</platforms>
            <distributionFileList>
                <distributionFile>
                    <allowWildcards>1</allowWildcards>
                    <origin>JREs/jre1.7.0_15-windows/java-windows/*</origin>
                </distributionFile>
            </distributionFileList>
            <ruleList>
                <isTrue value="${java_install_jre}"/>
            </ruleList>
        </folder>
        <folder>
            <description>Java binaries - Mac OS X</description>
            <destination>${installdir}/javavm</destination>
            <name>java_osx</name>
            <platforms>osx</platforms>
            <distributionFileList>
                <distributionFile>
                    <allowWildcards>1</allowWildcards>
                    <origin>JREs/jre1.7.0_15-osx/java-osx/*</origin>
                </distributionFile>
            </distributionFileList>
            <ruleList>
                <isTrue value="${java_install_jre}"/>
            </ruleList>
        </folder>
    </folderList>

	<!-- parameters for creating Java launchers -->
	<parameterList>
        <stringParameter name="java_launcher_destination" value="${installdir}" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>40</width>
        </stringParameter>
        <stringParameter name="java_launcher_binary_name" value="${project.shortName}-${product_version}.${platform_exec_suffix}" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <leftImage>vcell.gif</leftImage>
            <width>40</width>
        </stringParameter>
        <stringParameter name="java_launcher_arguments" value="" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>40</width>
        </stringParameter>
        <stringParameter name="java_launcher_vm_parameters" value="" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>40</width>
        </stringParameter>
        <stringParameter name="java_launcher_jar" value="" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>40</width>
        </stringParameter>
        <stringParameter name="java_launcher_mainClass" value="" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>40</width>
        </stringParameter>
        <stringParameter name="java_launcher_classpath" value="" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>40</width>
        </stringParameter>
        <stringParameter name="java_launcher_startmenu_shortcut_name" value="${project.fullName} ${product_version}" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <width>40</width>
        </stringParameter>
        <booleanParameter name="java_launcher_add_to_win_startmenu" value="1" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
        </booleanParameter>
        <booleanParameter name="java_install_jre" value="1" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
        </booleanParameter>
        <booleanParameter name="java_create_launcher" value="1" ask="0">
            <description></description>
            <explanation></explanation>
            <default></default>
        </booleanParameter>
    </parameterList>
    <postInstallationActionList>
	<!-- change permissions of all binaries -->
	<changePermissions abortOnError="0" files="${installdir}/javavm/bin/*" permissions="0755" showMessageOnError="0">
            <ruleList>
                <fileExists path="${installdir}/javavm/bin"/>
                <platformTest negate="1" type="windows"/>
            </ruleList>
        </changePermissions>

	<!-- Create symbolic links on various platforms -->
	<actionGroup>
            <actionList>
                <createSymLink linkName="${installdir}/java" target="java">
                    <ruleList>
                        <fileExists path="${installdir}/javavm/bin"/>
                        <fileExists path="${installdir}/javavm/bin/java"/>
                    </ruleList>
                </createSymLink>
            </actionList>
            <ruleList>
                <platformTest type="osx"/>
            </ruleList>
        </actionGroup>

	<!-- create Java launcher using preferred JRE -->
	<createJavaLaunchers>
            <destination>${java_launcher_destination}</destination>
            <explanation>${msg(Installer.Java.CreateLaunchers.Explanation)}</explanation>
            <progressText>${msg(Installer.Java.CreateLaunchers.Text)}</progressText>
            <javaLauncherList>
                <javaLauncher>
                    <allowCommandLineArguments>1</allowCommandLineArguments>
                    <arguments>http://vcell.org/webstart/Alpha/vcellalpha.jnlp</arguments>
                    <binaryName>${java_launcher_binary_name}</binaryName>
                    <classpath>${java_launcher_classpath}</classpath>
                    <jarFile>${java_launcher_jar}</jarFile>
                    <mainClass>${java_launcher_mainClass}</mainClass>
                    <preferredJavaBinary>${javaws_executable}</preferredJavaBinary>
                    <runInConsole>0</runInConsole>
                    <vmParameters>${java_launcher_vm_parameters}</vmParameters>
                    <windowsResourceFileVersion>${project.version}</windowsResourceFileVersion>
                    <workingDirectory>${java_launcher_destination}</workingDirectory>
                </javaLauncher>
            </javaLauncherList>
            <ruleList>
                <isTrue value="${java_create_launcher}"/>
            </ruleList>
        </createJavaLaunchers>

	<!-- create start menu shortcut(s) on Microsoft Windows -->
	<actionGroup>
            <actionList>
                <setInstallerVariable>
                    <name>java_launcher_startmenudirectory</name>
                    <value>${windows_folder_programs}</value>
                </setInstallerVariable>
                <setInstallerVariable>
                    <name>java_launcher_startmenudirectory</name>
                    <value>${windows_folder_common_programs}</value>
                    <ruleList>
                        <compareText logic="does_not_equal" text="${project.installationScope}" value="user"/>
                        <isTrue value="${installer_is_root_install}"/>
                    </ruleList>
                </setInstallerVariable>
                <setInstallerVariable>
                    <name>java_launcher_startmenudirectory</name>
                    <value>${java_launcher_startmenudirectory}/${project.startMenuGroupName}</value>
                </setInstallerVariable>
                <createDirectory>
                    <path>${java_launcher_startmenudirectory}</path>
                </createDirectory>
                <createShortcuts>
                    <destination>${java_launcher_startmenudirectory}</destination>
                    <explanation>${msg(Installer.Java.CreateLauncherShortcuts.Explanation)}</explanation>
                    <progressText>${msg(Installer.Java.CreateLauncherShortcuts.Text)}</progressText>
                    <shortcutList>
                        <startMenuShortcut>
                            <comment>${java_launcher_binary_name}</comment>
                            <name>${java_launcher_startmenu_shortcut_name}</name>
                            <runAsAdmin>0</runAsAdmin>
                            <runInTerminal>0</runInTerminal>
                            <windowsExec>${java_launcher_destination}/${java_launcher_binary_name}</windowsExec>
                            <windowsExecArgs></windowsExecArgs>
                            <windowsIcon></windowsIcon>
                            <windowsPath>${java_launcher_destination}</windowsPath>
                        </startMenuShortcut>
                    </shortcutList>
                </createShortcuts>
            </actionList>
            <ruleList>
                <platformTest type="windows"/>
                <isTrue value="${java_launcher_add_to_win_startmenu}"/>
                <isTrue value="${java_create_launcher}"/>
            </ruleList>
        </actionGroup>
    </postInstallationActionList>

	<!-- set Java information -->
	<readyToInstallActionList>
        <if>
            <actionList>
                <setInstallerVariable name="java_version_major" value="1.7"/>
                <setInstallerVariable name="java_version" value="1.7.0"/>
                <setInstallerVariable name="java_version_full" value="1.7.0_15"/>
                <setInstallerVariable name="java_version_vendor" value="Sun"/>
                <setInstallerVariable name="java_bitness" value="32"/>

	<!-- determine Java binary name - javaw.exe on Windows, java otherwise -->
	<setInstallerVariable>
                    <name>java_executable</name>
                    <value>${installdir}/javavm/bin/java</value>
                </setInstallerVariable>
                <setInstallerVariable>
                    <name>java_executable</name>
                    <value>${installdir}/javavm/bin/javaw.exe</value>
                    <ruleList>
                        <platformTest type="windows"/>
                    </ruleList>
                </setInstallerVariable>
            </actionList>
            <conditionRuleList>
                <isTrue value="${java_install_jre}"/>
            </conditionRuleList>
            <elseActionList>
                <setInstallerVariable>
                    <name>java_executable</name>
                    <value></value>
                </setInstallerVariable>
            </elseActionList>
        </if>
    </readyToInstallActionList>
</component>
